<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<h2>(Tips & tricks)</h2>
</section>
<section id="top">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p style="font-size:80%;text-align:left">Typically, we don't have enough time to discuss all of the capabilities of Cytoscape visualizations.  
	This module tries to fill in some of the gaps.  Here are the topics we're going to cover:
	<ul style="font-size:80%">
		<li><a href="#more_styles">More about styles</a></li>
		<li><a href="#text">Working with text</a></li>
		<li><a href="#node_position">Controlling node position</a></li>
		<li><a href="#layout_tools">Adjusting the view (Node Position Tools)</a></li>
		<li><a href="#layout_tuning">Tuning layouts</a></li>
		<li><a href="#annotation">Graphical annotations (marks)</a></li>
		<li><a href="#color">Working with palettes</a></li>
		<li><a href="#node_graphics">Add graphics to nodes</a></li>
		<li><a href="#animation">Animations made easy</a></li>
	</ul>
</section>

<section id="more_styles">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>1. More about styles</highlight></p>
	<ul style="font-size:80%">
		<li>There are many styles that are not shown by default</li>
		<li class="fragment" data-fragment-index="1">Style columns are <highlight>Def.</highlight> (default), 
			<highlight>Map.</highlight> (mapping), and <highlight>Byp.</highlight> (bypass)</li>
		<li class="fragment" data-fragment-index="3">Bypass is used to override (bypass) both the mapping (if any) and the default</li>
		<li class="fragment" data-fragment-index="3">To set a node or edge bypass
			<ol>
				<li>select the nodes or edges you want to set the visual property</li>
				<li>click on the bypass column for the visual property you want to set</li>
				<li>set the value as appropriate</li>
			</ol>
		</li>
		<li class="fragment" data-fragment-index="8">Now, those properties will be permanently set for those nodes or edges</li>
		<li class="fragment" data-fragment-index="8">To clear the value, select the nodes or edgges again, right-click on the bypass column and select <b>Remove Bypass</b></li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:0px;left:150px">
		<img class="fragment fade-out plain" data-fragment-index="1" src="modules/advanced-visualization/NodeStyleProperties.png" height="800px"/>
		<img class="fragment fade-out plain" data-fragment-index="1" src="modules/advanced-visualization/EdgeStyleProperties.png" height="800px"/>
	</div>
	<div class="fragment" data-fragment-index="2" style="position:absolute;top:400px;left:500px">
		<img class="fragment fade-out plain" data-fragment-index="3" src="modules/advanced-visualization/StyleColumns.png" height="200px"/>
	</div>

	<div class="fragment" data-fragment-index="4" style="position:absolute;top:200px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="6" src="modules/advanced-visualization/FillColorMapped.png"/>
	</div>
	<div class="fragment" data-fragment-index="5" style="position:absolute;top:300px;left:300px">
		<img class="fragment fade-out plain" data-fragment-index="6" src="modules/advanced-visualization/ColorChooser.png" />
	</div>
	<div class="fragment" data-fragment-index="6" style="position:absolute;top:200px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="7" src="modules/advanced-visualization/BypassColor1.png" />
	</div>
	<div class="fragment" data-fragment-index="7" style="position:absolute;top:200px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="8" src="modules/advanced-visualization/BypassColor2.png" />
	</div>
	<!-- Defaults, mappings, and bypasses
	 Missing visual properties -->
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section id="column_styles">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>1. More about styles</highlight></p>
  <ul>
    <li>Column styles:
      <ul style="font-size: 90%">
        <li>Column styles control the way data values are shown in the various tables (node, edge, network)</li>
        <li>Like node and edge styles, column styles can be mapped using column data values</li>
        <li>In order to use column styles, you need to add each column and then set the style for that column</li>
      </ul>
    </li>
  </ul>
	<div class="fragment" data-fragment-index="1" style="position:absolute;top:200px;left:10px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/ColumnStyles.png"/>
	</div>
  <h2>Try it!</h2>
</section>

<section id="text">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>2. Working with fonts</highlight></p>
	<ul style="font-size:80%">
		<li>Cytoscape has several label/font properties that are not shown by default</li>
		<li>The following properties are available:
      <ul style="font-size: 80%">
				<li><b>Label</b>: usually used to set up a passthrough mapping for the label text</li>
				<li><b>Label Autorotate</b>: (for edges only) rotate the label to be parallel with the edge</li>
				<li><b>Label Font Face</b>: this is the font face to use -- usually a very long list</li>
				<li><b>Label Font Size</b>: the font size, can also be a passthrough mapping</li>
				<li><b>Label Position</b>: where the font should be placed</li>
				<li><b>Label Transparency</b>: the transparency of the font</li>
				<li><b>Label Width</b>: the maximum width of the label.  Labels longer than this will be wrapped</li>
        <li><b>Label Rotation</b>: the angle of the text in degrees</li>
        <li><b>Label Background Color</b>: the color of the text background</li>
        <li><b>Label Background Shape</b>: the shape of the text background</li>
        <li><b>Label Background Transparency</b>: the transparency of the text background</li>
			</ul>
		</li>
    <li>Label position and rotation can also be done interactively for node and edge labels.</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="1" src="modules/advanced-visualization/NodeLabelProperties.png"/>
	</div>
	<div class="fragment" data-fragment-index="1" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/EdgeLabelProperties.png"/>
	</div>
	<div class="fragment" data-fragment-index="2" style="position:absolute;top:0px;left:250px">
		<img class="fragment fade-out plain" data-fragment-index="3" src="modules/advanced-visualization/LabelPosition.png" height="850px"/>
	</div>
	<div class="fragment" data-fragment-index="3" style="position:absolute;top:0px;left:250px">
		<img class="plain" src="modules/advanced-visualization/EdgeLabelPosition.png" height="850px"/>
	</div>
	<aside class="notes" data-markdown>
* Show live
	</aside>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>2. Working with fonts</highlight></p>
	<h2>Try it!</h2>
</section>

<section id="node_position">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	3. Controlling node and edge position (depth)
	</highlight></p>
	<ul style="font-size: 80%">
		<li>Nodes and edges with the same Z order are drawn at the same time</li>
		<li>This can lead to important information being obscured</li>
		<li>Z order can be set by the <b>Z Location</b> visual property</li>
		<li>Nodes or edges with larger Z are drawn closer to the viewer (on top)</li>
		<li>Setting lots of different <b>Z Location</b> values can slow down graphics performance</li>
		<li>Best approach is to use a few different <b>Z Location</b> values or to set it manually using a <b>Bypass</b></li>
	</ul>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	3. Controlling node and edge position (depth)
	</highlight></p>
	<h2>Try it!</h2>
</section>

<section id="layout_tools">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>4. Adjusting the view</highlight></p>
	<ul>
		<li style="list-style-type:none">Node layout tools (<b>Layout&rarr;Node Layout Tools</b>) provide important
			tools to help "tweak" the final look of a network</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="1" src="modules/advanced-visualization/NodeLayoutTools.png"/>
	</div>
	<div class="fragment fade-in" data-fragment-index="1" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/NodeTools1.png"/>
	</div>
	<div class="fragment fade-in" data-fragment-index="2" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="3" src="modules/advanced-visualization/NodeToolsRotate.png"/>
	</div>
	<div class="fragment fade-in" data-fragment-index="3" style="position:absolute;top:100px;left:200px">
		<img class="fragment fade-out plain" data-fragment-index="4" src="modules/advanced-visualization/NodeToolsScaled.png"/>
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
	<aside class="notes" data-markdown>
* Talk through individual parts.
* Make sure to mention the <b>selected</b> checkboxes
* Note selected nodes
* Rotated and moved -- rotation can help switch a network from portrait to landscape
* Scaled down -- note: particularly useful for scaling entire network to make more space
	</aside>
</section>

<section id="layout_tuning">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	5. Tuning layouts
	</highlight></p>
	<div style="float:right;margin-top:-100px">
		<img class="plain" src="modules/advanced-visualization/LayoutSettings.png" width="600px"/>
	</div>
	<div style="width: 600px;font-size:80%">
	<p style="margin-left: -20px">In general, most layouts can be "tuned" to improve the aesthetics.  My approach:
	<ol style="font-size:80%">
		<li>Bring up the settings <b>Layout&rarr;Settings</b></li>
		<li>Select the layout of choice (e.g. <b>Prefuse Force Directed Layout</b>).</li>
		<li>Change a parameter (e.g. <b>Default Spring Coefficient</b> or <b>Default Spring Length</b>)</li>
		<li>Click <b>Apply Layout</b></li>
		<li>Observe results.  If I get the result I want, click <b>Done</b>, otherwise, hit <b>Edit&rarr;Undo</b> and go to step 3</li>
	</ol>
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
	<aside class="notes" data-markdown>
* After talking through panel, switch to Cytoscape and show
	</aside>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	5. Tuning layouts
	</highlight></p>
	<h2>Try it!</h2>
	<p>Play with both the node layout tools and layout tuning</p>
</section>


<section id="annotations">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	6. Working with annotations (marks)
	</highlight></p>
	<ul style="font-size:80%">
		<li>Cytoscape has three separate drawing surfaces:
			<ul>
				<li>Network canvas (where nodes and edges are drawn)</li>
				<li>Background canvas (drawing surface behind the nodes and edges</li>
				<li>Foreground canvas (drawing surface in front of the nodes and edges</li>
			</ul>
		</li>
		<li>Annotations are drawn on either the foreground or background canvases</li>
		<li>Annotations are exported as <a href="modules/advanced-visualization/AnnotationExample.pdf">objects</a>, so are high quality graphically<sup>*</sup></li>
		<li>Annotation types:
			<ul>
				<li>Shapes, Text, Bounded Text, Images, Arrows</li>
				<li>Groups, which group annotations together</li>
			</ul>
		</li>
		<li>The Annotation Panel makes working with annotations easy and intuitive!</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:0px;left:0px">
		<img class="plain" data-fragment-index="1" src="modules/advanced-visualization/AnnotationExample.png" />
	</div>
	<aside class="notes" data-markdown>
* Recreate the above example in Cytoscape, starting with galFiltered.cys
	</aside>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	6. Working with annotations (marks)
	</highlight></p>
	<h2>Try it!</h2>
</section>

<section id="color">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	7. Palettes
	</highlight></p>
	<ul style="font-size:80%">
		<li>Cytoscape now supports palettes for choosing colors</li>
		<li>Three palette types are supported:
			<ul>
				<li><b>Sequential</b>: used for gradients with only positive or negative values</li>
				<li><b>Divergent</b>: used for gradients with both positive and negative values</li>
				<li><b>Qualitative</b>: used for discrete color mapping</li>
			</ul>
		</li>
		<li>The following palettes are provided by default:
			<ul>
				<li><b>ColorBrewer</b>: provides all three palette types</li>
				<li><b>Viridis</b>: provides sequential palettes</li>
				<li><b>Built-in</b>: built-in Rainbow, Rainbow OSC, and Random qualitative palettes, and a variety of built-in divergent palettes</li>
			</ul>
		</li>
		<li>Palettes are also used to select colors, when a current palette is defined</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:100px;left:150px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/ContinuousMapper.png" height="800px"/>
	</div>
	<div class="fragment" data-fragment-index="1" style="position:absolute;top:50px;left:0px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/PaletteChooser.png" height="600xp"/>
	</div>
	<div class="fragment" data-fragment-index="2" style="position:absolute;top:100px;left:150px">
		<img class="plain" src="modules/advanced-visualization/ContinuousMapper2.png" height="800px"/>
	</div>
	<div class="fragment" data-fragment-index="3" style="position:absolute;top:50px;left:0px">
		<img class="plain" src="modules/advanced-visualization/ColorChooser.png" height="600xp"/>
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section id="node_graphics">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	8. Adding graphics to nodes
	</highlight></p>
	<ul>
		<li style="list-style-type: none">Sometimes, we want to map graphics onto nodes</li>
		<li style="list-style-type: none">This should be done very sparingly</li>
		<li style="list-style-type: none">Using Cytoscape's built-in charts
			<ul style="font-size: 80%">
				<li><b>Image/Chart 1</b> is included by default</li>
				<li>Additional charts can be added via <b>Properties&rarr;Paint&rarr;Custom Paint...</b></li>
				<li>Mappings aren't really supported for charts, so select either the Default, or (if one or more nodes are selected, by Bypass) column.</li>
				<li>This will bring up the Graphics panel</li>
				<li>Click on Charts or Gradients as desired</li>
			</ul>
		</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:100px;left:50px">
		<img class="plain" src="modules/advanced-visualization/Charts1.png" />
	</div>
	<div class="fragment" data-fragment-index="1" style="position:absolute;top:100px;left:50px">
		<img class="plain" src="modules/advanced-visualization/Charts2.png" />
	</div>
	<div class="fragment" data-fragment-index="2" style="position:absolute;top:100px;left:50px">
		<img class="plain" src="modules/advanced-visualization/Charts3.png" />
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section >
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	8. Adding graphics to nodes
	</highlight></p>
	<ul style="font-size:80%">
		<li style="list-style-type: none"><i>enhancedGraphics</i> was written before Cytoscape charts were added to the core</li>
		<li style="list-style-type: none">The format is not nearly as convenient, but allows for greater flexibility and specificity</li>
		<li style="list-style-type: none">Adding a chart to a node is simple:
			<ol>
				<li>Create a new text column in the node table</li>
				<li>Add the chart instructions (see below for samples)</li>
				<li>Set up a visual style that uses the column you created as a passthrough mapping for one of the CustomGraphics styles.</li>
			</ol>
		</li>
	</ul>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section >
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	8. Adding graphics to nodes
	</highlight></p>
	<ul style="font-size:80%">
		<li style="list-style-type: none">Some example chart instructions:
			<ul style="font-size:80%">
				<li>Basic charts:
					<ul style="font-size:90%">
						<li>linechart: colorlist="up:blue,down:red" attributelist="Values"</li>
						<li>piechart: attributelist="Values" colorlist="contrasting" labellist="First,Second,Third,Fourth,Fifth"</li>
						<li>piechart: attributelist="a,b,c,d" colorlist="red,green,blue,yellow"</li>
						<li>barchart: attributelist="a,b,c,d" colorlist="up:yellow,down:green"</li>
						<li>stripechart: colorlist="red,white,blue"</li>
						<li>heatstripchart: separation="1" valuelist=".2,-1,3,1" labellist="cond1,cond2,cond3,cond4"</li>
					</ul>
				</li>
				<li>Circos charts:
					<ul style="font-size:90%">
						<li>circoschart: firstarc=.5 arcwidth=.4 colorlist="red, green, blue, white" showlabels=false attributelist="Circle1,Circle2"</li>
						<li>circoschart: arcstart=90 firstarc=.5 arcwidth=.3 range="-5,5" colorlist="up:yellow,down:blue,zero:black" valuelist="1,1,1,1" showlabels=false attributelist="Circle1,Circle2"</li>
					</ul>
				</li>
				<li>"Label" charts:
					<ul>
						<li>label: attribute=name labelsize=10 outline=true background=true color=white dropShadow=true</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:0px;left:0px">
		<img class="plain" src="modules/advanced-visualization/enhancedGraphicsScreenshot.png" />
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	8. Adding graphics to nodes
	</highlight></p>
	<ul>
		<li style="list-style-type: none">Apps that create custom paints:
			<ul>
				<li><a href="https://apps.cytoscape.org/apps/chemviz2">chemViz2</a>: draws chemical structure onto nodes</li>
				<li><a href="https://apps.cytoscape.org/apps/enhancedGraphics">enhancedGraphics</a>: used to draw charts and labels onto nodes</li>
				<li><a href="https://apps.cytoscape.org/apps/stringApp">stringApp</a>: uses custom paint for the "glass sphere" look, calls chemViz2 for chemical drawings, enhancedGraphics for "fancy" labels</li>
				<li><a href="https://apps.cytoscape.org/apps/omicsvisualizer">OmicsVisualizer</a>: uses enhancedGraphics for rings of data</li>
			</ul>
		</li>
	</ul>

	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section id="animation">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	9. Animations made easy
	</highlight></p>
	<ul>
		<li>The <i>CyAnimator</i> app is a key frame animation tools for Cytoscape</li>
		<li>To use, bring up the interface (<b>Apps&rarr;CyAnimator</b>)</li>
		<li>Add a frame to the animation by clicking the <b>+</b> button</li>
	</ul>
	<div class="fragment" data-fragment-index="0" style="position:absolute;top:100px;left:150px">
		<img class="fragment fade-out plain" data-fragment-index="1" src="modules/advanced-visualization/CyAnimator1.png" />
	</div>
	<div class="fragment" data-fragment-index="1" style="position:absolute;top:100px;left:150px">
		<img class="fragment fade-out plain" data-fragment-index="2" src="modules/advanced-visualization/CyAnimator2.png" />
	</div>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
</section>

<section>
	<div style="height:800px">
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>
	9. Animations made easy
	</highlight></p>
	<video height="600px" controls data-autoplay src="modules/advanced-visualization/CyAnimator.mp4" type="video/mp4"/>
	<div style="position:absolute;left:-50px;top:-50px"> <b style="font-size:60%"><a href="#top">Top</a></b> </div>
	</div>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>Try it out!</highlight></p>
</section>

<section>
	<h1 style="font-size:160%">Advanced Visualization in Cytoscape</h1>
	<p><highlight>Questions?</highlight></p>
        <p>Additional examples: <a href="https://github.com/cytoscape/cytoscape-tutorials/wiki#data-visualization" target="_blank">Step-by-step protocols</a>
</section>

