<section>
    <h1>Functional Enrichment Analysis</h1>
    <p><highlight>Cytoscape is an open source software platform for integrating, visualizing, and analyzing measurement data in the context of networks.</highlight></p>

    <p>This tutorial will take you through a functional enrichment workflow in Cytoscape. Key aspects covered
 in this tutorial are:</p>

    <ul>
        <li>Retrieve Networks and Pathways</li>
        <li>Integrate and Explore Your Data</li>
        <li>Perform Functional Enrichment Analysis</li>
        <li>Functional Interpretation and Display</li>
    </ul>
<div class="footer" style="position: absolute; left: -5em; bottom: -4em; ">
<img class="plain" src="../assets/images/Cytoscape.png" style="height:70px;opacity:0.5"> 
<version>3.6.0</version></div>
</section>

<section>
    <h3>1. Launch Cytoscape</h3>
    <p>If this is your first time launching Cytoscape, refer the <a href="http://manual.cytoscape.org">manual</a> for a basic introduction.</p>
    <br />
    <h3>2. Load apps</h3>
    <p>Go to the app store  to install the <a href="http://apps.cytoscape.org/apps/functionalenrichmentcollection">Functional Enrichment Collection</a>.</p>
</section>

<section>
    <h3>3. Load TCGA data</h3>
    <ul>
		<highlight>1. Create the network.</highlight>
        <li>Download
			<a href="https://cytoscape.github.io/cytoscape-tutorials/protocols/data/GBM-TP-all.tsv">GBM-TP.all.tsv</a>.</li> 
		<li>Import the file to create a network using <b>File → Import → Network → File</b>. <br/>This will bring up the <b>Import Network From Table</b> dialog.</li>
		<ul>
			<li>Select <b>Select None</b> to disable all columns.</li>
			<li>Click only on the <b>GeneName</b> column and set this column as the <b>Source Node</b> column (green circle).</li>
			<li>Click <b>OK</b>. You’ll see a warning about no edges, but that’s OK. This will create a grid of 1500 unconnected nodes, where each node represents a gene.</li>
    </ul>
    <div class="cybrowser">
    <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network import url  url=https://raw.githubusercontent.com/cytoscape/cytoscape-tutorials/gh-pages/protocols/data/GBM-TP-nodes.csv indexColumnSourceInteraction=1');" value="Import network"/></div>
    <br />
		
    
		<highlight>2. Add data to our nodes.</highlight>
			<li>Open the file again, but now use <b>File → Import → Table → File</b>.
				<br/>This will bring up the <b>Import Columns From Table</b> dialog.</li>
			<ul>
				<li>It turns out that all of the defaults are correct for just importing the data, so click on <b>OK</b>.</li>
				<li>This will import all of the data in the spreadsheet and associate each row with the corresponding node.</li>
				<li>You should be able to see this in the <b>Table Panel</b>.</li>
            </ul>
    <div class="cybrowser">
    <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('table import url url=https://raw.githubusercontent.com/cytoscape/cytoscape-tutorials/gh-pages/protocols/data/GBM-TP-all.tsv firstRowAsColumnNames=true TargetNetworkList=GBM-TP-nodes.csv keyColumnIndex=1 startLoadRow=1');" value="Load data"/>
    </div>
    </ul>

</section>

<section>
	<h3>4. Find significant expression changes</h3>
	<p>We’ll use the <b>Select</b> tab in the <b>Control Panel</b> to find the significant overall expression changes.</p>  
    <ul>
    <img plain src="modules/functional-enrichment/select-tab.png" style="width:25%; float:right; margin-left: 10px">
    <li>Open the <b>Select</b> tab and click on the + button to add a new condition. In this case we’re going to add a <b>Column Filter</b>. Select the "Mean log2FC" column and set the values to be between -5 and -1. This will select all genes that are significantly underexpressed on average, across all samples (only one gene should be selected).</li>
    <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=RPS4Y1');" value="Select significantly underexpressed nodes"/> <!-- can this be done in any other way? -->
    </div>
    <li>Repeat the same process as above, but set the values to be between 1 and 5. You’ll also need to change the type of match (at the top of the panel) to <b>Match any (OR)</b>. No additional genes will be selected in this case (but this approach will be reused later).</li>
       <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=RPS4Y1');" value="Select significantly changed nodes"/>
    </div>
    </ul>
</section>

<section>
    <p>Only one gene shows significant average expression changes across all samples, <highlight>RPS4Y1</highlight>, a ribosomal protein that has been shown to be linked to glioblastoma, but it’s still a relatively unsatisfying result that only a single protein changes expression in glioblastoma patients. A closer examination might be in order...</p>  
</section>

<section>
    <h3>5. Cluster to see expression patterns</h3>
    <p>Let’s cluster all of the data to see if there are any significant patterns that have been averaged out by looking at all samples in the aggregate. <b>clusterMaker2</b> is a Cytoscape app that provides a number of clustering algorithms including hierarchical and k-means.</p>
    <ul>
    <li><highlight>Perform hierarchical clustering.</highlight> In Cytoscape, select <b>Apps → clusterMaker → Hierarchical cluster</b>. This will bring the settings for hierarchical clustering. Select all of the samples (TCGA-*) in the <b>Node attributes for cluster</b> list. The checkboxes <b>Cluster attributes as well as nodes</b>, <b>Ignore nodes/edges with no data</b>, and <b>Show TreeView when complete</b> should all be checked. Then click <b>OK</b>. The resulting TreeView should look like the figure on the next slide.</li>
    <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('cluster hierarchical clusterAttributes=true ignoreMissing=true nodeAttributeList=&quot;TCGA-02-0001-01,TCGA-02-0003-01,TCGA-02-0004-01,TCGA-02-0007-01,TCGA-02-0009-01,TCGA-02-0010-01,TCGA-02-0011-01,TCGA-02-0014-01,TCGA-02-0015-01,TCGA-02-0016-01,TCGA-02-0021-01,TCGA-02-0023-01,TCGA-02-0024-01,TCGA-02-0025-01,TCGA-02-0026-01,TCGA-02-0027-01,TCGA-02-0028-01,TCGA-02-0033-01,TCGA-02-0034-01,TCGA-02-0038-01,TCGA-02-0039-01,TCGA-02-0043-01,TCGA-02-0046-01,TCGA-02-0047-01,TCGA-02-0048-01,TCGA-02-0051-01,TCGA-02-0052-01,TCGA-02-0054-01,TCGA-02-0057-01,TCGA-02-0058-01,TCGA-02-0059-01,TCGA-02-0060-01,TCGA-02-0064-01,TCGA-02-0068-01,TCGA-02-0069-01,TCGA-02-0070-01,TCGA-02-0071-01,TCGA-02-0074-01,TCGA-02-0075-01,TCGA-02-0079-01,TCGA-02-0080-01,TCGA-02-0083-01,TCGA-02-0084-01,TCGA-02-0085-01,TCGA-02-0086-01,TCGA-02-0087-01,TCGA-02-0089-01,TCGA-02-0099-01,TCGA-02-0102-01,TCGA-02-0104-01,TCGA-02-0106-01,TCGA-02-0107-01,TCGA-02-0111-01,TCGA-02-0113-01,TCGA-02-0114-01,TCGA-02-0115-01,TCGA-02-0116-01,TCGA-02-0258-01,TCGA-02-0260-01,TCGA-02-0266-01,TCGA-02-0269-01,TCGA-02-0271-01,TCGA-02-0281-01,TCGA-02-0285-01,TCGA-02-0289-01,TCGA-02-0290-01,TCGA-02-0317-01,TCGA-02-0321-01,TCGA-02-0324-01,TCGA-02-0325-01,TCGA-02-0326-01,TCGA-02-0330-01,TCGA-02-0332-01,TCGA-02-0333-01,TCGA-02-0337-01,TCGA-02-0338-01,TCGA-02-0339-01,TCGA-02-0422-01,TCGA-02-0430-01,TCGA-02-0432-01,TCGA-02-0439-01,TCGA-02-0440-01,TCGA-02-0446-01,TCGA-02-0451-01,TCGA-02-0456-01,TCGA-02-2466-01,TCGA-02-2470-01,TCGA-02-2483-01,TCGA-02-2485-01,TCGA-02-2486-01,TCGA-06-0122-01,TCGA-06-0124-01,TCGA-06-0125-01,TCGA-06-0126-01,TCGA-06-0127-01,TCGA-06-0128-01,TCGA-06-0129-01,TCGA-06-0130-01,TCGA-06-0132-01,TCGA-06-0133-01,TCGA-06-0137-01,TCGA-06-0138-01,TCGA-06-0139-01,TCGA-06-0140-01,TCGA-06-0141-01,TCGA-06-0142-01,TCGA-06-0143-01,TCGA-06-0145-01,TCGA-06-0146-01,TCGA-06-0147-01,TCGA-06-0148-01,TCGA-06-0149-01,TCGA-06-0152-01,TCGA-06-0154-01,TCGA-06-0155-01,TCGA-06-0156-01,TCGA-06-0157-01,TCGA-06-0158-01,TCGA-06-0160-01,TCGA-06-0162-01,TCGA-06-0164-01,TCGA-06-0166-01,TCGA-06-0167-01,TCGA-06-0168-01,TCGA-06-0169-01,TCGA-06-0171-01,TCGA-06-0173-01,TCGA-06-0174-01,TCGA-06-0175-01,TCGA-06-0176-01,TCGA-06-0177-01,TCGA-06-0178-01,TCGA-06-0179-01,TCGA-06-0182-01,TCGA-06-0184-01,TCGA-06-0185-01,TCGA-06-0187-01,TCGA-06-0188-01,TCGA-06-0189-01,TCGA-06-0190-01,TCGA-06-0192-01,TCGA-06-0194-01,TCGA-06-0195-01,TCGA-06-0197-01,TCGA-06-0201-01,TCGA-06-0206-01,TCGA-06-0208-01,TCGA-06-0210-01,TCGA-06-0211-01,TCGA-06-0213-01,TCGA-06-0214-01,TCGA-06-0216-01,TCGA-06-0219-01,TCGA-06-0221-01,TCGA-06-0237-01,TCGA-06-0238-01,TCGA-06-0240-01,TCGA-06-0241-01,TCGA-06-0394-01,TCGA-06-0397-01,TCGA-06-0402-01,TCGA-06-0409-01,TCGA-06-0410-01,TCGA-06-0412-01,TCGA-06-0413-01,TCGA-06-0414-01,TCGA-06-0644-01,TCGA-06-0645-01,TCGA-06-0646-01,TCGA-06-0648-01,TCGA-06-0649-01,TCGA-06-0650-01,TCGA-06-0686-01,TCGA-06-0743-01,TCGA-06-0744-01,TCGA-06-0745-01,TCGA-06-0747-01,TCGA-06-0749-01,TCGA-06-0750-01,TCGA-06-0875-01,TCGA-06-0876-01,TCGA-06-0877-01,TCGA-06-0878-01,TCGA-06-0879-01,TCGA-06-0881-01,TCGA-06-0882-01,TCGA-06-0939-01,TCGA-06-1084-01,TCGA-06-1086-01,TCGA-06-1087-01,TCGA-06-1800-01,TCGA-06-1801-01,TCGA-06-1802-01,TCGA-06-1804-01,TCGA-06-1805-01,TCGA-06-2557-01,TCGA-06-2558-01,TCGA-06-2559-01,TCGA-06-2561-01,TCGA-06-2562-01,TCGA-06-2563-01,TCGA-06-2564-01,TCGA-06-2565-01,TCGA-06-2566-01,TCGA-06-2567-01,TCGA-06-2569-01,TCGA-06-2570-01,TCGA-06-5408-01,TCGA-06-5410-01,TCGA-06-5411-01,TCGA-06-5412-01,TCGA-06-5413-01,TCGA-06-5414-01,TCGA-06-5415-01,TCGA-06-5416-01,TCGA-06-5417-01,TCGA-06-5418-01,TCGA-06-5856-01,TCGA-06-5858-01,TCGA-06-5859-01,TCGA-06-6389-01,TCGA-06-6390-01,TCGA-06-6391-01,TCGA-08-0244-01,TCGA-08-0245-01,TCGA-08-0246-01,TCGA-08-0344-01,TCGA-08-0345-01,TCGA-08-0346-01,TCGA-08-0347-01,TCGA-08-0348-01,TCGA-08-0349-01,TCGA-08-0350-01,TCGA-08-0351-01,TCGA-08-0352-01,TCGA-08-0353-01,TCGA-08-0354-01,TCGA-08-0355-01,TCGA-08-0356-01,TCGA-08-0357-01,TCGA-08-0358-01,TCGA-08-0359-01,TCGA-08-0360-01,TCGA-08-0373-01,TCGA-08-0375-01,TCGA-08-0380-01,TCGA-08-0385-01,TCGA-08-0386-01,TCGA-08-0389-01,TCGA-08-0390-01,TCGA-08-0392-01,TCGA-08-0509-01,TCGA-08-0510-01,TCGA-08-0511-01,TCGA-08-0512-01,TCGA-08-0514-01,TCGA-08-0516-01,TCGA-08-0517-01,TCGA-08-0518-01,TCGA-08-0520-01,TCGA-08-0521-01,TCGA-08-0522-01,TCGA-08-0524-01,TCGA-08-0525-01,TCGA-08-0529-01,TCGA-08-0531-01,TCGA-12-0616-01,TCGA-12-0618-01,TCGA-12-0619-01,TCGA-12-0620-01,TCGA-12-0654-01,TCGA-12-0656-01,TCGA-12-0657-01,TCGA-12-0670-01,TCGA-12-0688-01,TCGA-12-0692-01,TCGA-12-0703-01,TCGA-12-0707-01,TCGA-12-0772-01,TCGA-12-0773-01,TCGA-12-0775-01,TCGA-12-0776-01,TCGA-12-0778-01,TCGA-12-0780-01,TCGA-12-0818-01,TCGA-12-0819-01,TCGA-12-0820-01,TCGA-12-0821-01,TCGA-12-0822-01,TCGA-12-0826-01,TCGA-12-0827-01,TCGA-12-0828-01,TCGA-12-0829-01,TCGA-12-1088-01,TCGA-12-1089-01,TCGA-12-1090-01,TCGA-12-1091-01,TCGA-12-1092-01,TCGA-12-1093-01,TCGA-12-1094-01,TCGA-12-1095-01,TCGA-12-1096-01,TCGA-12-1097-01,TCGA-12-1098-01,TCGA-12-1099-01,TCGA-12-1597-01,TCGA-12-1598-01,TCGA-12-1599-01,TCGA-12-1600-01,TCGA-12-1602-01,TCGA-12-3644-01,TCGA-12-3646-01,TCGA-12-3648-01,TCGA-12-3649-01,TCGA-12-3650-01,TCGA-12-3651-01,TCGA-12-3652-01,TCGA-12-3653-01,TCGA-12-5295-01,TCGA-12-5299-01,TCGA-12-5301-01,TCGA-14-0736-01,TCGA-14-0781-01,TCGA-14-0783-01,TCGA-14-0786-01,TCGA-14-0787-01,TCGA-14-0789-01,TCGA-14-0790-01,TCGA-14-0812-01,TCGA-14-0813-01,TCGA-14-0817-01,TCGA-14-0865-01,TCGA-14-0866-01,TCGA-14-0867-01,TCGA-14-0871-01,TCGA-14-1034-01,TCGA-14-1037-01,TCGA-14-1396-01,TCGA-14-1401-01,TCGA-14-1402-01,TCGA-14-1451-01,TCGA-14-1452-01,TCGA-14-1453-01,TCGA-14-1454-01,TCGA-14-1455-01,TCGA-14-1456-01,TCGA-14-1458-01,TCGA-14-1459-01,TCGA-14-1794-01,TCGA-14-1795-01,TCGA-14-1821-01,TCGA-14-1823-01,TCGA-14-1825-01,TCGA-14-1827-01,TCGA-14-1829-01,TCGA-14-2554-01,TCGA-14-2555-01,TCGA-14-3476-01,TCGA-14-3477-01,TCGA-14-4157-01,TCGA-15-0742-01,TCGA-15-1444-01,TCGA-15-1446-01,TCGA-15-1447-01,TCGA-15-1449-01,TCGA-16-0846-01,TCGA-16-0848-01,TCGA-16-0849-01,TCGA-16-0850-01,TCGA-16-0861-01,TCGA-16-1045-01,TCGA-16-1047-01,TCGA-16-1048-01,TCGA-16-1055-01,TCGA-16-1056-01,TCGA-16-1060-01,TCGA-16-1062-01,TCGA-16-1063-01,TCGA-16-1460-01,TCGA-19-0955-01,TCGA-19-0957-01,TCGA-19-0960-01,TCGA-19-0962-01,TCGA-19-0963-01,TCGA-19-0964-01,TCGA-19-1385-01,TCGA-19-1386-01,TCGA-19-1387-01,TCGA-19-1388-01,TCGA-19-1389-01,TCGA-19-1390-01,TCGA-19-1392-01,TCGA-19-1786-01,TCGA-19-1787-01,TCGA-19-1788-01,TCGA-19-1789-01,TCGA-19-1790-01,TCGA-19-1791-01,TCGA-19-2619-01,TCGA-19-2620-01,TCGA-19-2621-01,TCGA-19-2623-01,TCGA-19-2624-01,TCGA-19-2625-01,TCGA-19-2629-01,TCGA-19-2631-01,TCGA-19-4068-01,TCGA-19-5947-01,TCGA-19-5950-01,TCGA-19-5951-01,TCGA-19-5952-01,TCGA-19-5954-01,TCGA-19-5955-01,TCGA-19-5956-01,TCGA-19-5958-01,TCGA-19-5959-01,TCGA-19-5960-01,TCGA-26-1438-01,TCGA-26-1439-01,TCGA-26-1440-01,TCGA-26-1442-01,TCGA-26-1443-01,TCGA-26-1799-01,TCGA-26-5132-01,TCGA-26-5133-01,TCGA-26-5134-01,TCGA-26-5135-01,TCGA-26-5136-01,TCGA-26-5139-01,TCGA-27-1830-01,TCGA-27-1831-01,TCGA-27-1832-01,TCGA-27-1833-01,TCGA-27-1834-01,TCGA-27-1835-01,TCGA-27-1836-01,TCGA-27-1837-01,TCGA-27-1838-01,TCGA-27-2518-01,TCGA-27-2519-01,TCGA-27-2521-01,TCGA-27-2523-01,TCGA-27-2524-01,TCGA-27-2526-01,TCGA-27-2527-01,TCGA-27-2528-01,TCGA-28-1745-01,TCGA-28-1746-01,TCGA-28-1747-01,TCGA-28-1749-01,TCGA-28-1750-01,TCGA-28-1751-01,TCGA-28-1752-01,TCGA-28-1753-01,TCGA-28-1755-01,TCGA-28-1756-01,TCGA-28-1757-01,TCGA-28-1760-01,TCGA-28-2501-01,TCGA-28-2502-01,TCGA-28-2506-01,TCGA-28-2509-01,TCGA-28-2510-01,TCGA-28-2513-01,TCGA-28-2514-01,TCGA-28-5204-01,TCGA-28-5207-01,TCGA-28-5208-01,TCGA-28-5209-01,TCGA-28-5213-01,TCGA-28-5214-01,TCGA-28-5215-01,TCGA-28-5216-01,TCGA-28-5218-01,TCGA-28-5219-01,TCGA-28-5220-01,TCGA-28-6450-01,TCGA-32-1970-01,TCGA-32-1973-01,TCGA-32-1976-01,TCGA-32-1977-01,TCGA-32-1978-01,TCGA-32-1979-01,TCGA-32-1980-01,TCGA-32-1982-01,TCGA-32-1986-01,TCGA-32-1987-01,TCGA-32-1991-01,TCGA-32-2491-01,TCGA-32-2494-01,TCGA-32-2495-01,TCGA-32-2615-01,TCGA-32-2616-01,TCGA-32-2632-01,TCGA-32-2634-01,TCGA-32-2638-01,TCGA-32-4208-01,TCGA-32-4209-01,TCGA-32-4210-01,TCGA-32-4211-01,TCGA-32-4213-01,TCGA-32-4719-01,TCGA-32-5222-01,TCGA-41-2571-01,TCGA-41-2572-01,TCGA-41-2573-01,TCGA-41-2575-01,TCGA-41-3392-01,TCGA-41-3393-01,TCGA-41-3915-01,TCGA-41-4097-01,TCGA-41-5651-01,TCGA-76-4925-01,TCGA-76-4926-01,TCGA-76-4927-01,TCGA-76-4928-01,TCGA-76-4929-01,TCGA-76-4931-01,TCGA-76-4932-01,TCGA-76-4934-01,TCGA-76-4935-01,TCGA-76-6191-01,TCGA-76-6192-01,TCGA-76-6193-01,TCGA-76-6282-01,TCGA-76-6285-01,TCGA-81-5910-01,TCGA-87-5896-01&quot; showUI=true selectedOnly=false network=current');" value="Perform hierarchical clustering"/>
    </div>
    </ul>
</section>

<section>
    <p>Looking at the result, is seems like there are definite bands of expression data that look similar across a group of patients, but differ between groups. In fact, this reaffirms that there are known to be 4 different subtypes of glioblastoma. Let’s take that known data and see if we can subset the data into 4 subtypes.</p>
    <img plain src="modules/functional-enrichment/hierarchical.png" style="width:60%">

</section>

<section>
    <ul>
    <li><highlight>Perform k-means clustering.</highlight> In Cytoscape, select <b>Apps → clusterMaker → K-Means cluster</b>. In the resulting settings dialog, set the number of cluster to 4, which is the number of known subtypes of glioblastoma, as with the hierarchical cluster, select all of the samples (TCGA-*), check <b>Cluster attributes as well as nodes</b> and <b>Show HeatMap when complete</b>. This will result in a heat map similar to the one in the figure on the next slide. </li>
       <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('cluster kmeans clusterAttributes=true kNumber=4 nodeAttributeList=&quot;TCGA-02-0001-01,TCGA-02-0003-01,TCGA-02-0004-01,TCGA-02-0007-01,TCGA-02-0009-01,TCGA-02-0010-01,TCGA-02-0011-01,TCGA-02-0014-01,TCGA-02-0015-01,TCGA-02-0016-01,TCGA-02-0021-01,TCGA-02-0023-01,TCGA-02-0024-01,TCGA-02-0025-01,TCGA-02-0026-01,TCGA-02-0027-01,TCGA-02-0028-01,TCGA-02-0033-01,TCGA-02-0034-01,TCGA-02-0038-01,TCGA-02-0039-01,TCGA-02-0043-01,TCGA-02-0046-01,TCGA-02-0047-01,TCGA-02-0048-01,TCGA-02-0051-01,TCGA-02-0052-01,TCGA-02-0054-01,TCGA-02-0057-01,TCGA-02-0058-01,TCGA-02-0059-01,TCGA-02-0060-01,TCGA-02-0064-01,TCGA-02-0068-01,TCGA-02-0069-01,TCGA-02-0070-01,TCGA-02-0071-01,TCGA-02-0074-01,TCGA-02-0075-01,TCGA-02-0079-01,TCGA-02-0080-01,TCGA-02-0083-01,TCGA-02-0084-01,TCGA-02-0085-01,TCGA-02-0086-01,TCGA-02-0087-01,TCGA-02-0089-01,TCGA-02-0099-01,TCGA-02-0102-01,TCGA-02-0104-01,TCGA-02-0106-01,TCGA-02-0107-01,TCGA-02-0111-01,TCGA-02-0113-01,TCGA-02-0114-01,TCGA-02-0115-01,TCGA-02-0116-01,TCGA-02-0258-01,TCGA-02-0260-01,TCGA-02-0266-01,TCGA-02-0269-01,TCGA-02-0271-01,TCGA-02-0281-01,TCGA-02-0285-01,TCGA-02-0289-01,TCGA-02-0290-01,TCGA-02-0317-01,TCGA-02-0321-01,TCGA-02-0324-01,TCGA-02-0325-01,TCGA-02-0326-01,TCGA-02-0330-01,TCGA-02-0332-01,TCGA-02-0333-01,TCGA-02-0337-01,TCGA-02-0338-01,TCGA-02-0339-01,TCGA-02-0422-01,TCGA-02-0430-01,TCGA-02-0432-01,TCGA-02-0439-01,TCGA-02-0440-01,TCGA-02-0446-01,TCGA-02-0451-01,TCGA-02-0456-01,TCGA-02-2466-01,TCGA-02-2470-01,TCGA-02-2483-01,TCGA-02-2485-01,TCGA-02-2486-01,TCGA-06-0122-01,TCGA-06-0124-01,TCGA-06-0125-01,TCGA-06-0126-01,TCGA-06-0127-01,TCGA-06-0128-01,TCGA-06-0129-01,TCGA-06-0130-01,TCGA-06-0132-01,TCGA-06-0133-01,TCGA-06-0137-01,TCGA-06-0138-01,TCGA-06-0139-01,TCGA-06-0140-01,TCGA-06-0141-01,TCGA-06-0142-01,TCGA-06-0143-01,TCGA-06-0145-01,TCGA-06-0146-01,TCGA-06-0147-01,TCGA-06-0148-01,TCGA-06-0149-01,TCGA-06-0152-01,TCGA-06-0154-01,TCGA-06-0155-01,TCGA-06-0156-01,TCGA-06-0157-01,TCGA-06-0158-01,TCGA-06-0160-01,TCGA-06-0162-01,TCGA-06-0164-01,TCGA-06-0166-01,TCGA-06-0167-01,TCGA-06-0168-01,TCGA-06-0169-01,TCGA-06-0171-01,TCGA-06-0173-01,TCGA-06-0174-01,TCGA-06-0175-01,TCGA-06-0176-01,TCGA-06-0177-01,TCGA-06-0178-01,TCGA-06-0179-01,TCGA-06-0182-01,TCGA-06-0184-01,TCGA-06-0185-01,TCGA-06-0187-01,TCGA-06-0188-01,TCGA-06-0189-01,TCGA-06-0190-01,TCGA-06-0192-01,TCGA-06-0194-01,TCGA-06-0195-01,TCGA-06-0197-01,TCGA-06-0201-01,TCGA-06-0206-01,TCGA-06-0208-01,TCGA-06-0210-01,TCGA-06-0211-01,TCGA-06-0213-01,TCGA-06-0214-01,TCGA-06-0216-01,TCGA-06-0219-01,TCGA-06-0221-01,TCGA-06-0237-01,TCGA-06-0238-01,TCGA-06-0240-01,TCGA-06-0241-01,TCGA-06-0394-01,TCGA-06-0397-01,TCGA-06-0402-01,TCGA-06-0409-01,TCGA-06-0410-01,TCGA-06-0412-01,TCGA-06-0413-01,TCGA-06-0414-01,TCGA-06-0644-01,TCGA-06-0645-01,TCGA-06-0646-01,TCGA-06-0648-01,TCGA-06-0649-01,TCGA-06-0650-01,TCGA-06-0686-01,TCGA-06-0743-01,TCGA-06-0744-01,TCGA-06-0745-01,TCGA-06-0747-01,TCGA-06-0749-01,TCGA-06-0750-01,TCGA-06-0875-01,TCGA-06-0876-01,TCGA-06-0877-01,TCGA-06-0878-01,TCGA-06-0879-01,TCGA-06-0881-01,TCGA-06-0882-01,TCGA-06-0939-01,TCGA-06-1084-01,TCGA-06-1086-01,TCGA-06-1087-01,TCGA-06-1800-01,TCGA-06-1801-01,TCGA-06-1802-01,TCGA-06-1804-01,TCGA-06-1805-01,TCGA-06-2557-01,TCGA-06-2558-01,TCGA-06-2559-01,TCGA-06-2561-01,TCGA-06-2562-01,TCGA-06-2563-01,TCGA-06-2564-01,TCGA-06-2565-01,TCGA-06-2566-01,TCGA-06-2567-01,TCGA-06-2569-01,TCGA-06-2570-01,TCGA-06-5408-01,TCGA-06-5410-01,TCGA-06-5411-01,TCGA-06-5412-01,TCGA-06-5413-01,TCGA-06-5414-01,TCGA-06-5415-01,TCGA-06-5416-01,TCGA-06-5417-01,TCGA-06-5418-01,TCGA-06-5856-01,TCGA-06-5858-01,TCGA-06-5859-01,TCGA-06-6389-01,TCGA-06-6390-01,TCGA-06-6391-01,TCGA-08-0244-01,TCGA-08-0245-01,TCGA-08-0246-01,TCGA-08-0344-01,TCGA-08-0345-01,TCGA-08-0346-01,TCGA-08-0347-01,TCGA-08-0348-01,TCGA-08-0349-01,TCGA-08-0350-01,TCGA-08-0351-01,TCGA-08-0352-01,TCGA-08-0353-01,TCGA-08-0354-01,TCGA-08-0355-01,TCGA-08-0356-01,TCGA-08-0357-01,TCGA-08-0358-01,TCGA-08-0359-01,TCGA-08-0360-01,TCGA-08-0373-01,TCGA-08-0375-01,TCGA-08-0380-01,TCGA-08-0385-01,TCGA-08-0386-01,TCGA-08-0389-01,TCGA-08-0390-01,TCGA-08-0392-01,TCGA-08-0509-01,TCGA-08-0510-01,TCGA-08-0511-01,TCGA-08-0512-01,TCGA-08-0514-01,TCGA-08-0516-01,TCGA-08-0517-01,TCGA-08-0518-01,TCGA-08-0520-01,TCGA-08-0521-01,TCGA-08-0522-01,TCGA-08-0524-01,TCGA-08-0525-01,TCGA-08-0529-01,TCGA-08-0531-01,TCGA-12-0616-01,TCGA-12-0618-01,TCGA-12-0619-01,TCGA-12-0620-01,TCGA-12-0654-01,TCGA-12-0656-01,TCGA-12-0657-01,TCGA-12-0670-01,TCGA-12-0688-01,TCGA-12-0692-01,TCGA-12-0703-01,TCGA-12-0707-01,TCGA-12-0772-01,TCGA-12-0773-01,TCGA-12-0775-01,TCGA-12-0776-01,TCGA-12-0778-01,TCGA-12-0780-01,TCGA-12-0818-01,TCGA-12-0819-01,TCGA-12-0820-01,TCGA-12-0821-01,TCGA-12-0822-01,TCGA-12-0826-01,TCGA-12-0827-01,TCGA-12-0828-01,TCGA-12-0829-01,TCGA-12-1088-01,TCGA-12-1089-01,TCGA-12-1090-01,TCGA-12-1091-01,TCGA-12-1092-01,TCGA-12-1093-01,TCGA-12-1094-01,TCGA-12-1095-01,TCGA-12-1096-01,TCGA-12-1097-01,TCGA-12-1098-01,TCGA-12-1099-01,TCGA-12-1597-01,TCGA-12-1598-01,TCGA-12-1599-01,TCGA-12-1600-01,TCGA-12-1602-01,TCGA-12-3644-01,TCGA-12-3646-01,TCGA-12-3648-01,TCGA-12-3649-01,TCGA-12-3650-01,TCGA-12-3651-01,TCGA-12-3652-01,TCGA-12-3653-01,TCGA-12-5295-01,TCGA-12-5299-01,TCGA-12-5301-01,TCGA-14-0736-01,TCGA-14-0781-01,TCGA-14-0783-01,TCGA-14-0786-01,TCGA-14-0787-01,TCGA-14-0789-01,TCGA-14-0790-01,TCGA-14-0812-01,TCGA-14-0813-01,TCGA-14-0817-01,TCGA-14-0865-01,TCGA-14-0866-01,TCGA-14-0867-01,TCGA-14-0871-01,TCGA-14-1034-01,TCGA-14-1037-01,TCGA-14-1396-01,TCGA-14-1401-01,TCGA-14-1402-01,TCGA-14-1451-01,TCGA-14-1452-01,TCGA-14-1453-01,TCGA-14-1454-01,TCGA-14-1455-01,TCGA-14-1456-01,TCGA-14-1458-01,TCGA-14-1459-01,TCGA-14-1794-01,TCGA-14-1795-01,TCGA-14-1821-01,TCGA-14-1823-01,TCGA-14-1825-01,TCGA-14-1827-01,TCGA-14-1829-01,TCGA-14-2554-01,TCGA-14-2555-01,TCGA-14-3476-01,TCGA-14-3477-01,TCGA-14-4157-01,TCGA-15-0742-01,TCGA-15-1444-01,TCGA-15-1446-01,TCGA-15-1447-01,TCGA-15-1449-01,TCGA-16-0846-01,TCGA-16-0848-01,TCGA-16-0849-01,TCGA-16-0850-01,TCGA-16-0861-01,TCGA-16-1045-01,TCGA-16-1047-01,TCGA-16-1048-01,TCGA-16-1055-01,TCGA-16-1056-01,TCGA-16-1060-01,TCGA-16-1062-01,TCGA-16-1063-01,TCGA-16-1460-01,TCGA-19-0955-01,TCGA-19-0957-01,TCGA-19-0960-01,TCGA-19-0962-01,TCGA-19-0963-01,TCGA-19-0964-01,TCGA-19-1385-01,TCGA-19-1386-01,TCGA-19-1387-01,TCGA-19-1388-01,TCGA-19-1389-01,TCGA-19-1390-01,TCGA-19-1392-01,TCGA-19-1786-01,TCGA-19-1787-01,TCGA-19-1788-01,TCGA-19-1789-01,TCGA-19-1790-01,TCGA-19-1791-01,TCGA-19-2619-01,TCGA-19-2620-01,TCGA-19-2621-01,TCGA-19-2623-01,TCGA-19-2624-01,TCGA-19-2625-01,TCGA-19-2629-01,TCGA-19-2631-01,TCGA-19-4068-01,TCGA-19-5947-01,TCGA-19-5950-01,TCGA-19-5951-01,TCGA-19-5952-01,TCGA-19-5954-01,TCGA-19-5955-01,TCGA-19-5956-01,TCGA-19-5958-01,TCGA-19-5959-01,TCGA-19-5960-01,TCGA-26-1438-01,TCGA-26-1439-01,TCGA-26-1440-01,TCGA-26-1442-01,TCGA-26-1443-01,TCGA-26-1799-01,TCGA-26-5132-01,TCGA-26-5133-01,TCGA-26-5134-01,TCGA-26-5135-01,TCGA-26-5136-01,TCGA-26-5139-01,TCGA-27-1830-01,TCGA-27-1831-01,TCGA-27-1832-01,TCGA-27-1833-01,TCGA-27-1834-01,TCGA-27-1835-01,TCGA-27-1836-01,TCGA-27-1837-01,TCGA-27-1838-01,TCGA-27-2518-01,TCGA-27-2519-01,TCGA-27-2521-01,TCGA-27-2523-01,TCGA-27-2524-01,TCGA-27-2526-01,TCGA-27-2527-01,TCGA-27-2528-01,TCGA-28-1745-01,TCGA-28-1746-01,TCGA-28-1747-01,TCGA-28-1749-01,TCGA-28-1750-01,TCGA-28-1751-01,TCGA-28-1752-01,TCGA-28-1753-01,TCGA-28-1755-01,TCGA-28-1756-01,TCGA-28-1757-01,TCGA-28-1760-01,TCGA-28-2501-01,TCGA-28-2502-01,TCGA-28-2506-01,TCGA-28-2509-01,TCGA-28-2510-01,TCGA-28-2513-01,TCGA-28-2514-01,TCGA-28-5204-01,TCGA-28-5207-01,TCGA-28-5208-01,TCGA-28-5209-01,TCGA-28-5213-01,TCGA-28-5214-01,TCGA-28-5215-01,TCGA-28-5216-01,TCGA-28-5218-01,TCGA-28-5219-01,TCGA-28-5220-01,TCGA-28-6450-01,TCGA-32-1970-01,TCGA-32-1973-01,TCGA-32-1976-01,TCGA-32-1977-01,TCGA-32-1978-01,TCGA-32-1979-01,TCGA-32-1980-01,TCGA-32-1982-01,TCGA-32-1986-01,TCGA-32-1987-01,TCGA-32-1991-01,TCGA-32-2491-01,TCGA-32-2494-01,TCGA-32-2495-01,TCGA-32-2615-01,TCGA-32-2616-01,TCGA-32-2632-01,TCGA-32-2634-01,TCGA-32-2638-01,TCGA-32-4208-01,TCGA-32-4209-01,TCGA-32-4210-01,TCGA-32-4211-01,TCGA-32-4213-01,TCGA-32-4719-01,TCGA-32-5222-01,TCGA-41-2571-01,TCGA-41-2572-01,TCGA-41-2573-01,TCGA-41-2575-01,TCGA-41-3392-01,TCGA-41-3393-01,TCGA-41-3915-01,TCGA-41-4097-01,TCGA-41-5651-01,TCGA-76-4925-01,TCGA-76-4926-01,TCGA-76-4927-01,TCGA-76-4928-01,TCGA-76-4929-01,TCGA-76-4931-01,TCGA-76-4932-01,TCGA-76-4934-01,TCGA-76-4935-01,TCGA-76-6191-01,TCGA-76-6192-01,TCGA-76-6193-01,TCGA-76-6282-01,TCGA-76-6285-01,TCGA-81-5910-01,TCGA-87-5896-01&quot; selectedOnly=false network=current showUI=true');" value="Perform k-means clustering"/>
    </div>
    </ul>
    </section>

<section>
    <img plain src="modules/functional-enrichment/k-means.png" style="width:60%; float:right; margin-left: 10px">
    <p>Note that there are four distinct vertical bands (your results might vary in the ordering in either the vertical or horizontal dimensions). In fact, the firehose analyses identified the same four groupings of patients. In the spreadsheet loaded originally, we’ve calculated the mean Log2(fold change) for each of the four subtypes.</p>
    

</section>

<section>
    <h3>6. Find significant expression changes in Cluster 1</h3>
    <p>We are going to repeat step 4 with "Cluster 1 Mean log2FC" as the column. This represents the mean expression across the samples in cluster 1 (the leftmost cluster in the previous figure).</p>
    <ul>
    <li>Open the <b>Select</b> tab and setup two <b>Column Filters</b> for the "Cluster 1 Mean log2FC" column, one for up and one for down. Select the "Cluster 1 Mean log2FC" column and set the values to be between -5 and -1, then add a second filter (be sure to specify OR at the top) and set the values between 1 and 5.</li>
    <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;RTN1,C6ORF134,NDP,RPS4Y1,UBD,EDNRB,NCAN,NCALD,LPPR1,NAP1L3,TTYH1,TSPAN7,HP,TRIM9,MXRA5,DPP6,TREM1,C14ORF132,DLL3,REEP1,TPBG,TOX3,RASSF2,TNFAIP8,RARRES1,BIRC3,TMSL8,MMP7,BEX1,DCX,BCHE,MLC1,DCLK1,BCAN,BBOX1,MFAP2,BAI3,CYP1B1,B3GAT1,TIMP4,ATP6V1G2,PTGS2,ATP1B2,ATP1A2,MAPT,GRIA2,THBS1,CXCL9,MAP2,CXCL2,ASTN1,ASS1,GPRC5A,ASPN,TF,TDO2,ASCL1,TCEAL2,TAGLN3,CTSC,CTNND2,ARC,CTNNA2,AQP9,AQP4,CSTA,AQP1,APOD,LUM,CSPG5,LTBP2,POSTN,APBA2,LSAMP,CRYAB,LRRTM2,CRMP1,STMN4,PMAIP1,LRRN3,STMN2,CRIP1,STEAP1,PLP1,LPHN3,PLEKHB1,LOXL1,LOX,PLAUR,ALDOC,PLAU,LOC57228,GATM,COL6A3,COL6A2,LMO3,GAP43,SRPX2,COL5A1,PLA2G2A,AIM1,LIF,GABRB1,COL3A1,PKIA,COL1A2,AHNAK2,COL1A1,AGXT2L1,GABBR1,AGT,COL15A1,PID1,COBL,PHLPP,FXYD6,SOX11,CLASP2,CKB,SNCAIP,KIF5C,SNAP25,ABCC3,KIF1B,SLPI,KIF1A,CHRNA9,ABAT,PCSK1N,PCOLCE,SLC6A1,TLR4,FHL2,PAQR6,FCGR2B,KCNJ16,CDO1,KCND2,OMG,KAL1,CDH10,FAM70A,ITM2A,FAM5C,FAM5B,NUDT11,FAM131B,FAM107A,CD55,NTRK2,FABP7,F13A1,IL8,IL6,CCL20,SDC3,NOL4,NNMT,SCN3A,IGFBP6,SCG3,NKX2-2,WASF3,S100B,S100A9,S100A4,ELAVL4,NES,NDRG4,IER3,ID4&quot; network=current');" value="Select significant nodes in cluster 1"/> <!-- Have to do it this way until filters are commandized -->
    </div>
    </ul>
    <p>This should result in a selection of 171 nodes.</p>
</section>
<section>
    <h3>7. Download the PPI from STRING</h3>
    <ul>
    <li>From the above selection filter, we’ve identified 171 nodes that show an average <b>Log2FC greater than 1 or less than -1</b>, and selected those nodes. Now, we can create a network that includes all of those nodes by loading the protein-protein interaction data from STRING. Note that only the selected nodes are shown in the <b>Table Panel</b>.</li>
    </ul>
</section>

<section>
    <ul>
    <li><highlight>Select gene names from <b>Table Panel</b>.</highlight> Select everything in the <b>name</b> column by clicking into the first cell and then dragging down until you get to the bottom. Then, do a copy (<b>Control-C</b> or <b>Apple-C</b>).</li>
    <li><highlight>Paste gene names into STRING network search.</highlight> In the <b>Network</b> tab of the <b>Control Panel</b> at the top should be a text field with an icon at the left. Click on that icon and select <b>STRING protein query</b>. (If you don’t see any STRING options, the stringApp hasn’t been loaded.) Then click into the text field and paste the list of genes.</li>
    <li><highlight>Set STRING search parameters.</highlight> Next to the text field is a menu with a list of options. Change the <b>Confidence (score) cutoff</b> to 0.8 and the <b>Maximum additional interactors</b> to 30. This will get only high quality results (80% confidence) and add 30 extra proteins to the network.</li>
    </ul>
</section>

<section>
    <ul>
    <img plain src="modules/functional-enrichment/string-network.png" style="width:50%; float:right; margin-left: 10px">
    <li><highlight>Create the network.</highlight> Click on the search icon (magnifying glass) to load the network. The network should appear similar to the figure below.</li>
    <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('string protein query query=&quot;ABAT,ABCC3,AGT,AGXT2L1,AHNAK2,AIM1,ALDOC,APBA2,APOD,AQP1,AQP4,AQP9,ARC,ASCL1,ASPN,ASS1,ASTN1,ATP1A2,ATP1B2,ATP6V1G2,B3GAT1,BAI3,BBOX1,BCAN,BCHE,BEX1,BIRC3,C14ORF132,C6ORF134,CCL20,CD55,CDH10,CDO1,CHRNA9,CKB,CLASP2,COBL,COL15A1,COL1A1,COL1A2,COL3A1,COL5A1,COL6A2,COL6A3,CRIP1,CRMP1,CRYAB,CSPG5,CSTA,CTNNA2,CTNND2,CTSC,CXCL2,CXCL9,CYP1B1,DCLK1,DCX,DLL3,DPP6,EDNRB,ELAVL4,F13A1,FABP7,FAM107A,FAM131B,FAM5B,FAM5C,FAM70A,FCGR2B,FHL2,FXYD6,GABBR1,GABRB1,GAP43,GATM,GPRC5A,GRIA2,HP,ID4,IER3,IGFBP6,IL6,IL8,ITM2A,KAL1,KCND2,KCNJ16,KIF1A,KIF1B,KIF5C,LIF,LMO3,LOC57228,LOX,LOXL1,LPHN3,LPPR1,LRRN3,LRRTM2,LSAMP,LTBP2,LUM,MAP2,MAPT,MFAP2,MLC1,MMP7,MXRA5,NAP1L3,NCALD,NCAN,NDP,NDRG4,NES,NKX2-2,NNMT,NOL4,NTRK2,NUDT11,OMG,PAQR6,PCOLCE,PCSK1N,PHLPP,PID1,PKIA,PLA2G2A,PLAU,PLAUR,PLEKHB1,PLP1,PMAIP1,POSTN,PTGS2,RARRES1,RASSF2,REEP1,RPS4Y1,RTN1,S100A4,S100A9,S100B,SCG3,SCN3A,SDC3,SLC6A1,SLPI,SNAP25,SNCAIP,SOX11,SRPX2,STEAP1,STMN2,STMN4,TAGLN3,TCEAL2,TDO2,TF,THBS1,TIMP4,TLR4,TMSL8,TNFAIP8,TOX3,TPBG,TREM1,TRIM9,TSPAN7,TTYH1,UBD,WASF3&quot;');" value="Run STRING"/>
    </div>
    </ul>
</section>

<section>
    <h3>8. Style the network to show differential expression.</h3>
    <p>In this step, we’ll change the style of the network to highlight the differentially expressed genes.</p>
    <ul>
        <li><highlight>Re-import expression data.</highlight> First, we need to re-import the expression data for the new network created by the stringApp. Similar to the initial import, start by doing <b>File → Import → Table → File</b>. Again, select the <i>GBM-TP-all.tsv</i> file. However, now we need to use a different network column to match our names. Change the <b>Key Column for Network:</b> from <b>share name</b> to <b>query term</b>. STRING uses Ensembl identifiers, but retains the original query term so we can match data against. Now select <b>OK</b>.</li>
        <div class="cybrowser">
            
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('table import url url=https://raw.githubusercontent.com/cytoscape/cytoscape-tutorials/gh-pages/protocols/data/GBM-TP-all.tsv firstRowAsColumnNames=true TargetNetworkList=&quot;String Network&quot; keyColumnIndex=1 startLoadRow=1 KeyColumnForMapping=&quot;display name&quot;');" value="Load data"/>
        </div>
        
        <li><highlight>Disable structure image.</highlight> STRING provides some nice images of the 3D structure of the proteins, but we need to disable those to be able to see our expression values clearly. Disable the images by going to <b>Apps → STRING → Don’t show structure images</b>.</li>
    </ul>
        <!-- no command for this yet -->
</section>

<section>
    <ul>
        <img src="modules/functional-enrichment/continous-mapper.png" style="float:right; margin-left:10px">
        <li><highlight>Create color gradient for expression data.</highlight> To show the expression data, go the <b>Style </b>tab of the <b>Control Panel</b> and click on the middle square <b>(Map.)</b> of the three <b>Fill Color</b> controls. Set the Column to "Cluster 1 Mean log2FC" and set the <b>Mapping Type</b> to "Continuous Mapping". This will create a gray to white gradient. Double-click on the gradient to show the <b>Continuous Mapping Editor</b>. We’re going to use a Red/Blue color gradient, with blue representing underexpressed genes and red representing overexpressed genes. To start, click on the left-most triangle and set the color to Blue. This represents the values that are all less than the min. Repeat for the next triangle over. Now, set the two rightmost triangles to red.  Finally, since we don’t really want intermediate nodes to be purple, add an additional triangle by clicking on the Add button. Drag the new triangle to 0.0 and now click <b>OK</b>. The completed dialog should look like this:</li>
    </ul>
</section>

<section>
    <h3>9. Add styling to show mutations</h3>
    <p>In addition to expression fold change, the imported data also includes information about mutation, both across all patients and subdivided by cluster. It might be informative to add that information to our visualization.</p>
    <ul>
        <li><highlight>Lock node width and height.</highlight> By default, the <b>stringApp</b> provides separate values for Node Width and Node Height. In our case, we just want to lock them to be the same so we only have to modify the Node Size. The <b>Lock node width and height</b> is a checkbox at the bottom of the <b>Node</b> tab in the <b>Style</b> tab of the <b>Control Panel</b>. Make sure that it’s checked.</li>
        <li><highlight>Set the default node size.</highlight> Click on the leftmost (Def.) box next to <b>Size</b>. Set the default size to "45.0".</li>
        <!-- no command for this. could use "vizmap load file" and "vizmap apply" with a prebaked style, but need to enable loading style from URL -->
    </ul>
</section>

<section>
    <ul>
        <li><highlight>Map mutation to node size.</highlight> Click on the middle (Map.) box next to <b>Size</b>. Choose "Cluster 1 Mutations" for the <b>Column</b> and "Continuous Mapping" for the <b>Mapping Type</b>. Then double-click on the ramp that appears to bring up the <b>Continuous Mapping Editor</b>. Click on the leftmost triangle and set the <b>Node Size</b> to "45". Then click on the right-most triangle and set the <b>Node Size</b> to "90". Then check <b>OK</b>.</li>
        <br />
    <!-- no command for this. could use "vizmap apply" with a prebaked style -->
    </ul>
    <img plain src="modules/functional-enrichment/node-size-continous-mapper.png" style="width:60%">
</section>

<section>
    <ul>
    <li><highlight>Examine the network.</highlight> Examining the main connected component of the network, we immediately see that there is a group of overexpressed genes, <highlight>COL6A3, COL1A1, COL1A2, etc.</highlight>, that also exhibit some mutations. There is also a group of genes, <highlight>AGT, CXCL2, GABBR1 and KCNJ16</highlight> that show some mixed expression changes. Finally, there is a group of genes, including <highlight>NCAN, BCAN SDC3, and CSPG5</highlight>, in between these groups that show predominantly underexpression.</li>
    </ul>
</section>
<section>
    <p>At this point in our workflow, we have some options:</p>
    <p>One typical path might be to find all of the overexpressing genes, use the Diffusion app to perform heat diffusion through the network to grow the selection and then perform functional enrichment analysis on that set of genes and then repeat for underexpressing genes (see step 10).</p>
    <p>Another approach is suggested by the topology of the network, which strongly suggests groupings in the interactions. We can use clustering based on the network topology and to perform functional enrichment on each cluster (see step 12). We’ll take each of those in turn.</p>
</section>

<section>
    <h3>10. Smooth the network using Diffusion.</h3> 
    <p>When we created the STRING network, we added nodes to make sure that well connected nodes that might be silent (i.e. not exhibit changes in expression) could be included. Well connected genes might play a significant role in the biology even if their expression doesn’t change due to changes in the expression of their interaction partners. The Diffusion app supports the ability to find those genes by simulating the diffusion of heat through network connections.</p>
</section>

<section>
    <ul>
        <li><highlight>Create subnetwork of the main connected component.</highlight> Select all of the nodes and edges in the main connected component by holding mouse button 1 down and sweeping over the nodes. Alternatively, you could select a single node and then repeatedly hitting <b>Control-6</b> (or <b>⌘6</b> on the Mac) to continually select the first neighbors of selected nodes until all of the nodes in the connected component are selected. Once the entire component is selected, create a new network by doing <b>File → New → Network → From selected nodes, all edges</b>.</li>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;9606.ENSP00000285238,9606.ENSP00000355627,9606.ENSP00000295897,9606.ENSP00000226253,9606.ENSP00000453144,9606.ENSP00000345179,9606.ENSP00000284981,9606.ENSP00000311165,9606.ENSP00000372654,9606.ENSP00000219919,9606.ENSP00000349022,9606.ENSP00000266744,9606.ENSP00000364694,9606.ENSP00000253004,9606.ENSP00000354490,9606.ENSP00000250111,9606.ENSP00000302194,9606.ENSP00000307875,9606.ENSP00000263182,9606.ENSP00000331210,9606.ENSP00000264381,9606.ENSP00000263464,9606.ENSP00000351671,9606.ENSP00000316333,9606.ENSP00000264463,9606.ENSP00000299198,9606.ENSP00000364140,9606.ENSP00000225964,9606.ENSP00000297268,9606.ENSP00000304408,9606.ENSP00000360882,9606.ENSP00000300527,9606.ENSP00000295550,9606.ENSP00000321606,9606.ENSP00000227251,9606.ENSP00000373244,9606.ENSP00000264474,9606.ENSP00000418191,9606.ENSP00000307134,9606.ENSP00000227266,9606.ENSP00000427279,9606.ENSP00000354901,9606.ENSP00000260630,9606.ENSP00000255448,9606.ENSP00000337697,9606.ENSP00000367001,9606.ENSP00000366416,9606.ENSP00000349594,9606.ENSP00000264870,9606.ENSP00000357429,9606.ENSP00000356432,9606.ENSP00000351497,9606.ENSP00000264498,9606.ENSP00000322909,9606.ENSP00000260282,9606.ENSP00000366233,9606.ENSP00000377372,9606.ENSP00000229239,9606.ENSP00000264426,9606.ENSP00000348170,9606.ENSP00000367972,9606.ENSP00000259874,9606.ENSP00000301464,9606.ENSP00000258743,9606.ENSP00000306512,9606.ENSP00000250971,9606.ENSP00000362395,9606.ENSP00000262648,9606.ENSP00000333496,9606.ENSP00000283936,9606.ENSP00000322791,9606.ENSP00000263934,9606.ENSP00000393379,9606.ENSP00000249075,9606.ENSP00000312856,9606.ENSP00000231004,9606.ENSP00000261921,9606.ENSP00000422533,9606.ENSP00000261978,9606.ENSP00000266718,9606.ENSP00000353508,9606.ENSP00000215832,9606.ENSP00000263025,9606.ENSP00000340820,9606.ENSP00000314196,9606.ENSP00000364685,9606.ENSP00000310375,9606.ENSP00000260227,9606.ENSP00000220931,9606.ENSP00000252575,9606.ENSP00000367301,9606.ENSP00000357206,9606.ENSP00000366347,9606.ENSP00000299964,9606.ENSP00000277120,9606.ENSP00000247271,9606.ENSP00000223061,9606.ENSP00000262719,9606.ENSP00000336552,9606.ENSP00000364252,9606.ENSP00000361850,9606.ENSP00000339328,9606.ENSP00000305152,9606.ENSP00000326119,9606.ENSP00000369071,9606.ENSP00000351686,9606.ENSP00000356438,9606.ENSP00000250784,9606.ENSP00000267484,9606.ENSP00000346294,9606.ENSP00000357727,9606.ENSP00000291700,9606.ENSP00000283254,9606.ENSP00000344468,9606.ENSP00000342082,9606.ENSP00000254976,9606.ENSP00000261368,9606.ENSP00000362095,9606.ENSP00000429243,9606.ENSP00000273368,9606.ENSP00000444788,9606.ENSP00000385834,9606.ENSP00000260356,9606.ENSP00000287814,9606.ENSP00000363089,9606.ENSP00000398698,9606.ENSP00000421848,9606.ENSP00000358765,9606.ENSP00000244709,9606.ENSP00000298355,9606.ENSP00000367743,9606.ENSP00000366249,9606.ENSP00000335055&quot; network=&quot;STRING Network&quot;');" value="Select nodes"/> 
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network create excludeEdges=false networkName=&quot;STRING subnetwork&quot; nodeList=selected source=&quot;STRING Network&quot;');" value="Create subnetwork"/>
        </div>
        <li><highlight>Select overexpressed genes.</highlight> Go back to the <b>Select</b> tab and disable (click on the X) the filter for underexpressed genes, then click <b>Apply</b>.</li>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;9606.ENSP00000421848,9606.ENSP00000354901,9606.ENSP00000322909,9606.ENSP00000244709,9606.ENSP00000427279,9606.ENSP00000227266,9606.ENSP00000285238,9606.ENSP00000260227,9606.ENSP00000339328,9606.ENSP00000364694,9606.ENSP00000300527,9606.ENSP00000295550,9606.ENSP00000263464,9606.ENSP00000364140,9606.ENSP00000264474,9606.ENSP00000356438,9606.ENSP00000260356,9606.ENSP00000362095,9606.ENSP00000316333,9606.ENSP00000266718,9606.ENSP00000351671,9606.ENSP00000358765,9606.ENSP00000364252,9606.ENSP00000253004,9606.ENSP00000304408,9606.ENSP00000364685,9606.ENSP00000351497,9606.ENSP00000219919,9606.ENSP00000348170,9606.ENSP00000264870,9606.ENSP00000261921,9606.ENSP00000444788,9606.ENSP00000361850,9606.ENSP00000260630,9606.ENSP00000259874,9606.ENSP00000369071,9606.ENSP00000223061,9606.ENSP00000342082,9606.ENSP00000231004,9606.ENSP00000346294,9606.ENSP00000357727,9606.ENSP00000299964,9606.ENSP00000261978,9606.ENSP00000366249,9606.ENSP00000326119,9606.ENSP00000301464,9606.ENSP00000249075,9606.ENSP00000225964,9606.ENSP00000258743,9606.ENSP00000297268,9606.ENSP00000360882,9606.ENSP00000306512&quot;');" value="Select overexpressed genes"/> 
        </div>
		</ul>
</section>

<section>
	<ul>
        <li><highlight>Diffuse the selection.</highlight> In the diffusion app we can diffuse either based on the heat (column value) or just based on the selection. We’re going to diffuse based on our expression values, so select <b>Tools → Diffuse → Selected Nodes with Options</b> and in the dialog select "Cluster 1 Mean log2FC" as the <b>Heat Column</b> and set a short time of 0.001 seconds. Then click <b>OK</b>.</li>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('diffusion diffuse_advanced heatColumnName=&quot;Cluster 1 Mean log2FC&quot; time=0.001');" value="Diffuse the selection"/>
        </div>
        <li><highlight>Create subnetwork.</highlight> Change the <b>Node Rank</b> to about 40 and create a subnetwork by selecting <b>File → New → Network → From selected nodes, all edges</b>. Once the network is created, execute an unweighted Prefuse Force Directed Layout (<b>Layout → Prefuse Force Directed Layout → All Nodes (none)</b>).</li>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;9606.ENSP00000322909,9606.ENSP00000244709,9606.ENSP00000427279,9606.ENSP00000260227,9606.ENSP00000364694,9606.ENSP00000295550,9606.ENSP00000263464,9606.ENSP00000364140,9606.ENSP00000264474,9606.ENSP00000356438,9606.ENSP00000260356,9606.ENSP00000316333,9606.ENSP00000266718,9606.ENSP00000351671,9606.ENSP00000358765,9606.ENSP00000364252,9606.ENSP00000253004,9606.ENSP00000304408,9606.ENSP00000351497,9606.ENSP00000219919,9606.ENSP00000348170,9606.ENSP00000264870,9606.ENSP00000444788,9606.ENSP00000361850,9606.ENSP00000260630,9606.ENSP00000259874,9606.ENSP00000369071,9606.ENSP00000223061,9606.ENSP00000342082,9606.ENSP00000231004,9606.ENSP00000346294,9606.ENSP00000299964,9606.ENSP00000261978,9606.ENSP00000366249,9606.ENSP00000301464,9606.ENSP00000249075,9606.ENSP00000225964,9606.ENSP00000258743,9606.ENSP00000297268,9606.ENSP00000360882,9606.ENSP00000306512&quot;');" value="Set Node Rank to 40"/><!--this could be done directly with a command if Diffusion output was commandized -->    
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network create excludeEdges=false networkName=&quot;Diffusion subnetwork 1&quot; nodeList=selected source=current');" value="Create subnetwork 1"/>
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('layout force-directed network=&quot;Diffusion subnetwork 1&quot; nodeList=all');" value="Apply force-directed layout"/>

        </div>      
	</ul>
</section>

<section>
	<ul>
        <li><highlight>Repeat for underexpressed genes.</highlight> For underexpressed genes, repeat the previous steps above, except choose all genes with a "Cluster 1 Mean log2FC" less than -1 and in the diffusion app set the time to 0.01 seconds. Unfortunately the Diffusion Output assumes positive diffusion values, so to select the diffused nodes of interest, you’ll need to go to the Table Panel and sort the diffusion_output_heat column, select the negative values less than -0.5, right-click on the column and select <b>Select nodes from selected rows</b>. Then you can create the subnetwork.</li>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;9606.ENSP00000362395,9606.ENSP00000254976,9606.ENSP00000252575,9606.ENSP00000349594,9606.ENSP00000298355,9606.ENSP00000263934,9606.ENSP00000322791,9606.ENSP00000287814,9606.ENSP00000333496,9606.ENSP00000377372,9606.ENSP00000264463,9606.ENSP00000337697,9606.ENSP00000226253,9606.ENSP00000340820,9606.ENSP00000363089,9606.ENSP00000227251,9606.ENSP00000422533,9606.ENSP00000321606,9606.ENSP00000354490,9606.ENSP00000266744,9606.ENSP00000220931,9606.ENSP00000356432,9606.ENSP00000299198,9606.ENSP00000418191,9606.ENSP00000335055,9606.ENSP00000277120,9606.ENSP00000264381,9606.ENSP00000366233,9606.ENSP00000307875,9606.ENSP00000263182,9606.ENSP00000283936,9606.ENSP00000291700,9606.ENSP00000261368,9606.ENSP00000355627,9606.ENSP00000357429,9606.ENSP00000305152,9606.ENSP00000453144,9606.ENSP00000307134,9606.ENSP00000429243,9606.ENSP00000310375,9606.ENSP00000372654,9606.ENSP00000311165,9606.ENSP00000366416,9606.ENSP00000393379,9606.ENSP00000262648,9606.ENSP00000302194,9606.ENSP00000312856,9606.ENSP00000247271,9606.ENSP00000250111,9606.ENSP00000331210,9606.ENSP00000349022,9606.ENSP00000273368,9606.ENSP00000264426,9606.ENSP00000267484,9606.ENSP00000344468,9606.ENSP00000250784,9606.ENSP00000367001,9606.ENSP00000353508,9606.ENSP00000367743,9606.ENSP00000345179,9606.ENSP00000367301,9606.ENSP00000283254,9606.ENSP00000366347,9606.ENSP00000255448,9606.ENSP00000385834,9606.ENSP00000336552,9606.ENSP00000367972,9606.ENSP00000373244,9606.ENSP00000260282,9606.ENSP00000357206&quot; network=&quot;STRING subnetwork&quot;');" value="Select underexpressed genes"/> 
        </div>
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('diffusion diffuse_advanced heatColumnName=&quot;Cluster 1 Mean log2FC&quot; time=0.01');" value="Diffuse the selection"/>
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network select nodeList=&quot;9606.ENSP00000252575,9606.ENSP00000247271,9606.ENSP00000305152,9606.ENSP00000373244,9606.ENSP00000354490,9606.ENSP00000264426,9606.ENSP00000260282,9606.ENSP00000250784,9606.ENSP00000367001,9606.ENSP00000283254,9606.ENSP00000264381,9606.ENSP00000298355,9606.ENSP00000283936,9606.ENSP00000357429,9606.ENSP00000291700,9606.ENSP00000322791,9606.ENSP00000307134,9606.ENSP00000299198,9606.ENSP00000333496,9606.ENSP00000331210,9606.ENSP00000366347,9606.ENSP00000264463,9606.ENSP00000337697,9606.ENSP00000429243,9606.ENSP00000367743,9606.ENSP00000321606,9606.ENSP00000356432,9606.ENSP00000267484,9606.ENSP00000349594,9606.ENSP00000287814,9606.ENSP00000226253,9606.ENSP00000302194,9606.ENSP00000250111,9606.ENSP00000355627,9606.ENSP00000263182,9606.ENSP00000393379,9606.ENSP00000266744,9606.ENSP00000366416,9606.ENSP00000311165,9606.ENSP00000340820,9606.ENSP00000372654,9606.ENSP00000227251,9606.ENSP00000273368,9606.ENSP00000367972,9606.ENSP00000418191,9606.ENSP00000353508,9606.ENSP00000220931,9606.ENSP00000362395,9606.ENSP00000344468,9606.ENSP00000422533,9606.ENSP00000312856,9606.ENSP00000336552,9606.ENSP00000349022,9606.ENSP00000307875,9606.ENSP00000453144,9606.ENSP00000310375,9606.ENSP00000254976,9606.ENSP00000263934,9606.ENSP00000345179,9606.ENSP00000335055,9606.ENSP00000277120,9606.ENSP00000377372,9606.ENSP00000261368,9606.ENSP00000385834,9606.ENSP00000262648,9606.ENSP00000255448,9606.ENSP00000367301,9606.ENSP00000357206,9606.ENSP00000366233,9606.ENSP00000363089,9606.ENSP00000284981&quot;');" value="Select diffused nodes of interest"/>
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('network create excludeEdges=false networkName=&quot;Diffusion subnetwork 2&quot; nodeList=selected source=current');" value="Create subnetwork 2"/>
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('layout force-directed network=&quot;Diffusion subnetwork 2&quot; nodeList=all');" value="Apply force-directed layout"/> 
        </div>
    </ul>
</section>
<section>
    <h3>11.	Perform enrichment analysis on the diffused subnetworks.</h3>
    <p>There are many tools available in Cytoscape to perform functional enrichment. For simplicity we’re going to use the built-in functional enrichment available from the stringApp. The description below walks through calculating function enrichment of the overexpressed subnetwork, but the same approach will work for the underexpressed network.</p>

</section>

<section>
    <ul>
        <li><highlight>Set network as a STRING network.</highlight> In order to retrieve the function enrichment scores the stringApp needs to be told that this is a STRING network. A menu item is available for that purpose: <b>Apps → STRING → Set as STRING network.</b></li> <!-- this is not possible by commands -->
        <li><highlight>Retrieve functional enrichment of a component.</highlight> In the subnetwork, there are two connected components of any size. Select all of the nodes in the largest one and retrieve the functional enrichment through the <b>Apps → STRING → Retrieve functional enrichment</b>. This will bring up a new Table Panel tab for “STRING Enrichment”.</li>
        
        <!--This won't work until we have a way of setting the string network via commands
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('string retrieve enrichment');" value="Retrieve functional enrichment"/>
        </div>-->
            
        <li>There is a filter icon which bring up a menu to switch the ontology or pathway displayed. In the case of the largest component, we see that there is a significant overexpression of genes involved in the GO Biological Processes: extracellular matrix organization, collagen catabolic process, and other development processes; they are also associated with the KEGG pathways Protein digestion and absorption and ECM-receptor interaction.</li>
        
        <li><highlight>Repeat for other components.</highlight></li>
        <!--This won't work until we have a way of setting the string network via commands. But which components?
        <div class="cybrowser">
        <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('string retrieve enrichment');" value="Retrieve functional enrichment"/>
        </div>-->
        
    </ul>
</section>
<section>
    <h3>12. Topologically cluster the network.</h3> 
    <img plain src="modules/functional-enrichment/string-network2.png" style="width:40%; float:right; margin-left: 10px">
    <p>Looking at the protein-protein interaction network (left), we see that there appear to be strong connections between groups of nodes (see discussion in 9 above). One approach to explore the functional interactions of the network is to use a topological clustering algorithm to partition the network based on the interactions. The clusterMaker2 app provides a set of topological (network) cluster algorithms.  One commonly used one is MCL, which performs a Markov-based flow simulation to determine clusters.</p>
    
    
</section>
<section>
    <ul>
        <li><highlight>Cluster using MCL</highlight>. Make sure the network is connected, then go to <b>Apps → clusterMaker → MCL Cluster</b>. This will bring up the MCL settings dialog. There are a number of options, but most of these don’t require any changes for our uses. We’re going to treat the network as unweighted so we don’t need to provide any Array Sources. We do want to check the <b>Create new clustered network</b> however so we can visualize the results. Then click <b>OK</b>.</li>
        <div class="cybrowser">
            <input type="button" class="btn btn-primary" onclick="cybrowser.executeCyCommand('cluster mcl showUI=true network=&quot;String Network&quot;');" value="Perform MCL clustering"/> </div>
    </ul>
</section>
<section>
    <h3>13.	Determine functional enrichment of the clusters.</h3> 
    <img plain src="modules/functional-enrichment/topological-cluster.png" style="width:60%; float:right; margin-left: 10px">
		<p>The results of the clustering should look something like the figure on the right, which is a close-up of the largest components. Of particular interest are the largest 4 components, which we’ll perform functional enrichment.</p> 
</section>

<section>
    <ul>
        <li><highlight>Set network as a STRING network.</highlight> The first step is to inform the stringApp that this is a STRING-derived network. A menu item is available for that purpose: <b>Apps → STRING → Set as STRING network</b>.</li>
        <li><highlight>Retrieve functional enrichment of a component.</highlight> In the subnetwork, there are four connected components of any size. Select all of the nodes in the second largest one (the one with a number of overexpressed genes and the bulk of the mutations) and retrieve the functional enrichment through the <b>Apps → STRING → Retrieve functional enrichment</b>. This will bring up a new Table Panel tab for <b>STRING Enrichment</b>. There is a pull-down menu that switches the ontology or pathway displayed. Looking at the results we see that there is a significant overexpression of genes involved in the GO Biological Processes: extracellular matrix organization, collagen catabolic process, and other development processes; they are also associated with the KEGG pathways Protein digestion and absorption and ECM-receptor interaction.</li>
        <li><highlight>Repeat for other components.</highlight></li>
    </ul>
</section>