
<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Legend Creator Tutorial</title>

		<link rel="stylesheet" href="../../css/reveal.css">
		<link rel="stylesheet" href="../../css/theme/cytoscape-protocol-1.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../../lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../../css/print/pdf.css' : '../../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

<!-- ========================================================== -->
<!-- THIS IS WHERE YOUR CONTENT BEGINS -->

<!-- ========================================================== -->
<!-- ========================================================== -->
     
<!--This is a slide with text in the form of a list, a figure and a citation -->
<section id='introduction'>
<h1>Introduction</h1>

<p>If you haven't already, install the <a href="http://apps.cytoscape.org/apps/legendcreator" target="_blank">Legend Creator app</a>.</p>

<p>It can generate a legend that illustrates the visual mapping used in your graphs.</p>


<img style="float:center; width:45%" src="LC1.png">
<p>There is a variety of different features of the Legend Creator, but its primary function is to add a color gradient to quantify the mapping of fill color in a legend.  This is a common function in Cytoscape graphs and hard to recreate accurately if you use downstream programs (e.g., Adobe Illustrator) to annotate graphs for publication.
</p>

</section>

<!-- ========================================================== -->

<section id='background'>
<h1>Background</h1>

<p>First, let's review how <highlight>Styles</highlight> are used in Cytoscape.  In addition to setting <b>Default</b> values, one can also set <b>Mappings</b> to assign values based on data in node or edge table columns. 
</p>

<p>Mappings can be continuous or discrete.  The icon in the center column of the styles shows a double headed arrow for the right side of the icon for continuous mappings, and dots for discrete mappings.
</p>

<img style="float:right;" src="LC2.png">


<p>Continuous legends are made from numerical values, where the range is determined by looking at the node table, such as expression level.  We’ll look at those first.
</p><div style="float:left">
<small> <p><b>Note: </b> If you use Passthrough Mappings, they will not create a legend entry, and are not discussed here.
</p><br /></small> 
</div>

</section>

<!-- ========================================================== -->


<section id='setup'>
<h1>Setup</h1>


<p>
We need a network with some styles set to demonstrate this app. Let's load the <b>Yeast Perturbation</b> network, provided by Cytoscape as a sample session file. You can find the Sample Sessions in the <highlight>Starter Panel</highlight> when you first launch Cytoscape, or <b>View > Show Starter Panel</b> if it is hidden.
</p>
</section>

<!-- ========================================================== -->



<section id='controlpanel'>
<h1>Control Panel</h1>

<p>
In the Legend tab of the Control Panel, there is a button to scan the network, fields for the legend title and subtitle and then check boxes for the continuous and discrete mappings that are defined in the current style.  </p>
</p>
<p> <div style="float:right">
    <img class="shadow" src="LC6.png" style="height:350px"></div><br /><br />
    <p>

The <highlight>Scan Network </highlight>button will tell the program to traverse the style sheet and all of the nodes in the graph to figure out what legends to add and what values exist in the network so it can decide how to build each legend entry. 
</p>
<p>
 This scan happens automatically whenever you load or switch networks, so you only have to push the button manually if you edit the styles.  
 </p>
<p><small> <b>Note:</b> Legends are generated as annotations, and as such, are not updated dynamically. You must manually remove and recreate the legend if you change your styles.</small> 
</p>


<p>
</p>
<br /></section>

<!-- ========================================================== -->



<section id='controlpanel2'>
<h1>Control Panel</h1>

<p>
</p>
<p> <div style="float:right">
    <img class="shadow" src="LC6.png" style="height:350px"></div><br /><br />
    <p>

<p>
The title and subtitle are just text fields.  The name of the network goes into the default title, but you can enter whatever text you want.  You don’t have control over the font, size or alignment at this point, but I’ll show you how to edit those later.

</p>

<p>
Moving down the control panel, we see the list of mappings.  They show the name of the column in the node table followed by the name of the attribute to which it is mapped.  In this example, we have color mapped to our variable called gal1Rexp, shape is mapped to a column called <i>isLink</i>, and the size of a node is mapped to the number of neighbors, or its degree.

</p>

<p>
Check the Vertical Layout option, to position the legend along the right margin of the graph. <br> 
Check the box Draw Bounding Box if you want to include a rectangle surrounding all the legend entries.

</p>

<p>
Click <highlight>Add Legend  </highlight>button on the bottom of the panel.
</p>
<p>
</p>
<p>
</p>
<br /></section>

<!-- ========================================================== -->



<section id='firstDraft'>
<h1>First Draft</h1>

<p>
As you see, we got four components because we had all four mappings checked.    The first two are called Ramp Functions that show both node size and font size get bigger for nodes of higher degree, i.e., those with more neighbors.  Third, a color gradient entry shows expression level of our protein of interest.</p>
 <div style="float:right">
    <img class="shadow" src="LC7.png" style="height:350px"></div><br /><br />
    <p>

<p>
Depending on the story you are trying to tell with your presentation, many mappings don’t add much information. Sometimes mappings are redundant.  So it will often make sense to only show a small number of the possible items.  But the easiest way to decide is to just make the full legend, look at the result, delete the legend and remake it with fewer boxes checked.
</p>


</section>

<!-- ========================================================== -->



<section id='ramps'>
<h1>Ramp Functions</h1>

<p>
The first two are associated in that they both map measures of the nodes’ degree to the size of both the nodes and its label.  This is a continuous mapping, meaning there is a function that calculates the size of the node and font from a numerical column in the node table.
</p>

<p>
Note:  Although size is a useful attribute to map, showing it in a legend is often not too useful.  Our perception of size is qualitative.  We can tell big from small, but we can’t tell a 50 pixel diameter from 63 pixel diameter if they are not right next to each other and the same shape.  So adding a legend to show the quantitative measure of size tends not to add much to your drawing, and is optional or discouraged in many cases.
</p>

<img style="float:left;" src="LC8.png">
<img style="float:right;" src="LC9.png">
</section>
<!-- ========================================================== -->



<section id='gradient'>
<h1>Color Gradient</h1>

<p>
The next one is a color gradient.  It should match our continuous mapping for the variable <b>gal1RGexp</b> in the Style menu.   This is clearly the most important entry in our legend.  Perceptually, color attributes are the most powerful mapping and should be used for the strongest message you are trying to convey.  The human eye has very good color perception, even if the nodes are separated across the graph or are different shapes and sizes.  
</p>

<p>
<small> <b>Important Note: </b> Because color is such an important attribute perceptually, it is important to use color with care.  Rather than defining arbitrary colors for minimum and maximum values, it is important to use Palettes of colors that have been curated to make sure they have consistent color saturation across the range.  If you double click on the gradient, an editor will come up, with an button to choose palettes in the top left corner. 
 It is <i><b>highly recommended</b></i> to use defined palettes over arbitrary colors.</p>
</small>
<img style="float:left;" src="LCA.png">
<img style="float:right;" src="LCB.png">
</section>

<!-- ========================================================== -->



<section id='shape'>
<h1>Shape Legend</h1>

<p>
Another legend entry we could generate is a Shape Legend.  It is a discrete mapping, meaning that the values are listed explicitly, instead of being calculated from a function.

</p>

<p>

<img style="float:center;" src="LCC.png">
</section>

<!-- ========================================================== -->




<section id='kiss'>
<h1>Keep it Simple</h1>

<p>
Not every mapping used will necessitate an entry in the legend, and showing too many entries will distract from the graph. The legend entries to show size, line style, or shape, or color are separate components and can be included or not on an individual basis.
</p>
<p> Here is our network with three mappings shown:
</p>
<img style="float:left;width:60%" src="LC7.png">
</section>

<!-- ========================================================== -->


<section id='layout'>
<h1>Layout</h1>

<p>
If you lay out the legend horizontally, it will be placed at the bottom of the graph.  If you lay out the legend vertically, it will be positioned at the right of the graph.  
</p>
<p>
The legend is placed in a default position outside the bounds of the network.  Much of the time you’ll have to move it from where it shows up to where you want it.  This can be tricky, because the Cytoscape editor distinguishes annotations from nodes and treats them differently.  If I try to click on the legend, it will pan the screen, just like clicking on the background.
</p>
 <div style="float:right">
    <img class="shadow" src="LCG.png" style="height:350px"></div><br /><br />
    <p>

<p>
To move the legend, first go here to enable annotations to be active in the editor.   Then hold down the shift key while dragging to select items and the annotations get selected with nodes.  There is a yellow box around selected annotations.  Now they can be dragged.  

</p>
</section>

<!-- ========================================================== -->



<section id='annotation'>
<h1>Annotation Panel</h1>

<p>
</p>
 <div style="float:right">
    <img class="shadow" src="LCH.png" style="height:650px"></div><br/>
<p>
     To edit more specific aspects of the legend, such as the fonts or sizes, or the color of the background, you’ll want to go to the Annotation control panel.  There, you’ll see every label and tick of the legend in a list view. 
</p>
<p>
     There are several opertations available to edit annotations here:
</p>

<ul>
	<li > Add or remove items from the foreground or background layers.   </li>
    <li> Move items up or down, or move them between the layers.  </li>
    <li> Right-click and select <highlight>Modify Annotation... </highlight>to edit the item.  </li>
</ul>
</section>

<!-- ========================================================== -->



<section id='summary'>
<h1>Summary</h1>

<p>
This app creates legends for the most common attributes applied to nodes in your graph.</p>
<p>
It is also reasonable to want to make legends around edge attributes, such as line style, color and thickness, but that is not included in this first release. 
</p>
<p>
Cytoscape will tell you when the update is posted.
</p>
<p>
If you have problems, questions or feature requests, please contact me:<a href="mailto:AdamTreister@gladstone.ucsf.edu">AdamTreister@gladstone.ucsf.edu</a></p> </h5>

</section>

<!-- ========================================================== -->


                
<!-- THIS IS WHERE YOUR CONTENT ENDS -->
<!-- ========================================================== -->

                
			</div>
		</div>

		<script src="../../lib/js/head.min.js"></script>
		<script src="../../js/reveal.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-155159-15', 'auto');
  ga('send', 'pageview');
</script>
<script>
	Reveal.addEventListener( 'ready', function() {
	if(!window.navigator.userAgent.includes('CyBrowser')){
		var divs = document.getElementsByClassName("cybrowser")
		for (var i=0;i<divs.length;i++){
			divs[i].style.display = "none";
		}
	} else {
		var divs = document.getElementsByClassName("not-cybrowser")
		for (var i=0;i<divs.length;i++){
			divs[i].style.display = "none";
		}
	}
});
</script>  
		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,
				controls: true,
				progress: true,
				slideNumber: false,
				touch: true,
				fragments: true,
				help: true,
				showNotes: false,
				previewLinks: false,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				width: 1200,
				height: 860,
				autoSlide: 0,
				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
				{ src: '../../plugin/markdown/marked.js' },
				{ src: '../../plugin/markdown/markdown.js' },
				{ src: '../../plugin/zoom-js/zoom.js', async: true, condition: function(){ return !!document.body.classList; } },
				{ src: '../../plugin/notes/notes.js', async: true },
				{ src: '../../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				{ src: '../../plugin/external/external.js', condition: function() { return !!document.querySelector( '[data-external]' ); } }
				]
				});
			</script>
		</body>
	</html>
